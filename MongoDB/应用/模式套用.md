### 模式套用

 列转行，文档版本     子集，近似处理    预聚合，分桶

### 1、分桶模式，

比如分级航班每分钟产生一条数据，但是其实可以每小时产生一条数据，每分钟的数据用数组内嵌方式存入到这条数据中
   场景：时序数据，物联网，
   痛点：数据点采集频繁，数据量很大
   优点：利用**文档内嵌数组**，大量减少文档数量，大量减少索引占用空间

### 2、列转行例子

需要对多个字段进行查询，如果要加索引，会产生很多索引

```json
{
"city_beijing":"2023-09-11",
"city_hefei":"2023-04-11"
}
```
转换为数组，只需对country，date分别进行索引就可以了，减少索引

```json
{
    "city":[
      {"country":"beijing","date":"2023-09-11"}
      {"country":"hefei","date":"2023-04-11"}
    ]
}
```

### 文档版本例子

比如1.0时候有3个字段，2.0时有4个字段，这时候可以增加一个字段表示当前文档的版本，比如如果是2.0的版本就增加schema_version:"2.0",用于后期可能的字段检查  

### 近似计算
比如网站页面浏览量，可以近似统计下,减少写操作
if random(0,9) == 0 {
    increment by 10
}

### 预聚合例子
比如某些统计计算比较耗时，这时候可以额外增加几个统计字段，当数据变化时，去更新这几个字段，后面再统计时，就直接用这个几个字段统计就行了