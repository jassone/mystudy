## 大表为什么不能用自增主键
自增主键本身是没有什么问题的，**但是在分布式情况下使用是有严重问题的。**

## 一、缺点
![ff205c0019c346e497a8b2f5d93a203a.png](https://pic.imgdb.cn/item/61cc11432ab3f51d91c4078e.png)

### 1、资源浪费
如上图，你怎么知道哪个数据库中的分片，可以容纳 1 亿数据呢，这是不是猜的呢？

而且这种方式后面不能再扩展呢，因为设计的时候依据按照范围分片的方式已经设计好的。且自增主键必须连续只能采用”范围分片”形式。

### 2、尾部热点
自增主键分片又会带来一个附加的效应技术尾部热点，这是由范围分片自身的特定决定的。

比如说，现在我们的商品数据已经堆积到 2.5 亿，新的数据在插入的时候，所有的数据都被插入到了分片3中，之前的分片 1 、2 都不会有写入操作，所以表分片3中库的压力是非常大的。

当然，对于这样的情况也是有解决方案的。即 HASH 法，这种情况的分片相比范围法效率上高1.5倍之多。

## 二、是否可以使用UUID
不可以，因为UUID是无序的，作为主键会涉及大量索引重排，导致新增时耗时(页分裂)，引起IO激增。

## 三、解决方案
有没有一种分布式且有序的主键生成算法？

**可以使用分布式ID-Snowflake雪花算法。**



 