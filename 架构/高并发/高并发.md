## 高并发

## 一、数据读取延迟

### 1、cpu级别

- 一级缓存 0.5ns
- 分支预测 5ns
- 二级缓存读取 7ns 
- 互斥锁和解锁 100ns

### 2、内存级别

- 主内存读取 100ns
- 用zip压缩1K字节的数据 10us
- 从内存中顺序读取1M数据 250us

### 3、网络级别

- 1Gbps网络上发送1K数据  10us
- 同一数据中心的往返时间 500us
- 从网络上顺序读取1M数据 10ms
- 发送一个包从加州->荷兰->加州  150ms

### 4、硬盘级别

- 从ssd硬盘随机读取4K数据 150us
- 从ssd硬盘顺序读取1M数据 1ms
- 机械硬盘寻道时间 10ms
- 从机械硬盘上顺序读取1M数据 20ms

## 二、分析优劣点

### 1、内存 > 分布式内存  > ssd  > hdd

### 2、异步  > 同步

### 3、分布式  > 单机

## 三、高并发解决之道

### 1、数据就近访问

### 2、高性能存储

### 3、异步减少等待和缓冲

### 4、横向扩展：分布式集群



## 影响高并发的一些原因

反应到程序是运行时间长，系统占用高，内存占用高。最终影响高并发。

- 频繁加锁解锁
- ‘等’的过程，比如等待所有协程完成后再合并数据







