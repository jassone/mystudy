## 削峰填谷-流控方法

## 一、限流方案
详见“限流”章节

## 二、接入层(容器)限流
详见“nginx限流”章节

## 三、应用层限流-限时抢购限流方案
* 限制某个商品下单频率不可取，**限制服务接口的调用频率才是关键。**
* 在业务逻辑中硬编码方式嵌入限流代码，会代码侵入性问题，增加复杂度，灵活性差。

选择方案：**Alibaba Sentinel**

## 四、基于时间分片的削峰方案
调整业务来对流量进行消峰，是站在业务角度对系统实施保护的一种方式。

### 1、通过答题验证削峰
比如12306网站。

## 五、基于消息队列的解耦、削峰、最终一致性方案

异步调用能显著提升程序执行性能，通过消息中间件实现异步调用也是分布式中解决系统之间耦合及大流量削峰的重要手段。

分布式事务一直是业界难题，对于那些可接受数据存在短时间内不一致的业务场景来说，消息队列或许是最优的解决方案。

### 1、基于消息队列的典型案例
* 监控数据采集上报削峰
* 分库分表场景下订单冗余表的数据最终一致性


