## main

## 一、MQTT协议概述

### 1.1 简介

MQTT（**Message Queuing Telemetry Transport**）是一种轻量级的**发布/订阅模式**消息传输协议，专为**低带宽、高延迟或不可靠网络环境**下的[物联网](https://so.csdn.net/so/search?q=物联网&spm=1001.2101.3001.7020)（IoT）设备通信而设计。

### 1.2 协议特性

- 轻量高效
  - 协议头最小仅 **2字节**，适合资源受限设备（如传感器）及低带宽网络（如2G/蜂窝网络）。
- 灵活的服务质量（QoS）
  - **QoS 0**（最多一次）：消息可能丢失，适用于可容忍数据丢失的场景（如环境监测）。
  - **QoS 1**（至少一次）：确保消息到达，但可能重复（需订阅者去重）。
  - **QoS 2**（恰好一次）：通过握手机制保证消息不重复、不丢失，适合关键指令（如支付）。
- 适应弱网络环境
  - 支持高延迟、不稳定网络，自动处理连接中断（如断线重连、消息缓存）。
- 持久会话
  - 客户端可设置 `Clean Session` 标志，断开后代理保留订阅和未接收消息，恢复后继续通信。
- 遗嘱消息（Last Will）
  - 客户端异常断开时，代理自动发布预设的遗嘱消息，通知其他设备离线状态。



## 相关文档

- MQTT协议详解  https://blog.csdn.net/qq_45049184/article/details/147796780