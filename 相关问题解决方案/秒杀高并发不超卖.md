## 秒杀高并发不超卖
## 一、方案
### 1、方案1
![sdfghjkl.png](https://pic.imgdb.cn/item/61dfd90a2ab3f51d9154df58.png)

* **利用预减库存方式(decr key: 原子获取库存数量)杜绝超卖**
* 利用Nginx+Lua在网关层面将无效请求阻挡
* 利用MQ消息队列的`限流`特性保证MySQL不会被瞬间击垮
* APP需要额外设计轮询机制查询订单状态

##### 订单创建后，用户取消订单或未支付怎么办？
为订单设置过期时间，订单支付有效期过期或用户取消订单，LUA执行 incr “stk-1001” 自增即可。