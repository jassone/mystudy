## RPC
## 一、介绍
在golang中实现RPC非常简单，有封装好的官方库和一些第三方库提供支持。Go RPC可以利用tcp或http来传递数据，可以对要传递的数据使用多种类型的编解码方式。golang官方的net/rpc库使用encoding/gob进行编解码，支持tcp或http数据传输方式，由于其他语言不支持gob编解码方式，所以使用net/rpc库实现的RPC方法没办法进行跨语言调用。

golang官方还提供了net/rpc/jsonrpc库实现RPC方法，JSON RPC采用JSON进行数据编解码，因而支持跨语言调用。但目前的jsonrpc库是基于tcp协议实现的，暂时不支持使用http进行数据传输。

除了golang官方提供的rpc库，还有许多第三方库为在golang中实现RPC提供支持，大部分第三方rpc库的实现都是使用protobuf进行数据编解码，根据protobuf声明文件自动生成rpc方法定义与服务注册代码，在golang中可以很方便的进行rpc服务调用。

## 二、go 中 RPC
### 1、go写RPC程序，要符合4个基本条件
* 结构体字段首字母要大写，可以别人调用
* 函数名必须首字母大写
* 函数第一参数是接收参数，第二个参数是返回给客户端的参数，必须是指针类型
* 函数还必须有一个返回值error

### 2、RPC调用流程
* 微服务架构下数据交互一般是对内 RPC，对外 REST
* 将业务按功能模块拆分到各个微服务，具有提高项目协作效率、降低模块耦合度、提高系统可用性等优点，但是开发门槛比较高，比如 RPC 框架的使用、后期的服务监控等工作
* 一般情况下，我们会将功能代码在本地直接调用，微服务架构下，我们需要将这个函数作为单独的服务运行，客户端通过网络调用

### 3、网络传输数据格式
* 两端要约定好数据包的格式
* 成熟的RPC框架会有自定义传输协议，这里网络传输格式定义如下，前面是固定长度消息头，后面是变长消息体。
    ![3434343.jpeg](https://pic.imgdb.cn/item/624e3e24239250f7c511bfa1.jpg)
    
## 三、gRPC
gRPC由google开发，是一款语言中立、平台中立、开源的远程过程调用系统。

gRPC可以实现微服务，默认使用protocol buffers，这是google开源的一套成熟的结构数据序列化机制（当然也可以使用其他数据格式如JSON）。
    
    

